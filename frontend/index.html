<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0b0b14">
    <title>Squad.GG</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     SETUP SCREEN
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="setup-screen">
        <h1>SQUAD.GG</h1>
        <p>Chat + Games + AI</p>
        <input class="setup-field" id="inp-user" placeholder="Your username" autocomplete="off" spellcheck="false">
        <input class="setup-field" id="inp-room" placeholder="Room ID (e.g. 101)" autocomplete="off" spellcheck="false">
        <button class="btn-join" onclick="joinRoom()">Enter Room ‚Üí</button>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     APP SHELL (visible after join)
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="app">

        <!-- ‚îÄ‚îÄ Top bar ‚îÄ‚îÄ -->
        <div class="top-bar">
            <span class="logo">‚ö° SQUAD</span>
            <div class="room-pill" id="room-badge">Not connected</div>
            <div class="spacer"></div>
            <!-- Game tabs -->
            <button class="tab-btn active" id="tab-ludo" data-tab="ludo" onclick="switchTab('ludo')">üé≤ Ludo</button>
            <button class="tab-btn" id="tab-chess" data-tab="chess" onclick="switchTab('chess')">‚ôü Chess</button>
            <!-- Chat toggle (mobile only) -->
            <div class="chat-toggle-btn" id="chat-toggle-btn" onclick="toggleChat()" title="Chat">
                üí¨
                <div class="chat-badge" id="chat-badge">0</div>
            </div>
        </div>

        <!-- ‚îÄ‚îÄ Content area ‚îÄ‚îÄ -->
        <div class="content-area">

            <!-- ‚îÄ‚îÄ CHAT OVERLAY ‚îÄ‚îÄ -->
            <div class="chat-overlay collapsed" id="chat-overlay">
                <button class="chat-close-btn" onclick="toggleChat()">‚úï Close chat</button>
                <div class="chat-messages-float" id="chat-messages"></div>
                <div class="chat-input-bar">
                    <input type="file" id="file-inp" accept="image/*" style="display:none" onchange="handleFile(this)">
                    <div class="btn-file-img" onclick="document.getElementById('file-inp').click()" title="Image">üì∑
                    </div>
                    <input type="text" id="chat-inp" placeholder="Type something‚Ä¶" onkeypress="sendMsgOnEnter(event)"
                        autocomplete="off">
                    <button class="chat-send-btn" onclick="sendMsg()">Send</button>
                </div>
            </div>

            <!-- ‚îÄ‚îÄ GAME VIEW ‚îÄ‚îÄ -->
            <div class="game-view" id="game-view" style="display:none;">

                <!-- LOBBY -->
                <div class="lobby-view" id="lobby-view" style="display:flex;">
                    <div class="lobby-card">
                        <h2>üè† ROOM LOBBY</h2>
                        <!-- Player list -->
                        <div id="lobby-player-list"></div>

                        <!-- Game type selector -->
                        <div>
                            <div style="font-size:.78em;color:var(--text2);margin-bottom:6px;">Choose game:</div>
                            <div class="game-type-selector">
                                <div class="game-type-btn selected" data-type="ludo" onclick="selectGameType('ludo')">üé≤
                                    Ludo</div>
                                <div class="game-type-btn" data-type="chess" onclick="selectGameType('chess')">‚ôü Chess
                                </div>
                            </div>
                        </div>

                        <!-- Actions -->
                        <div class="lobby-actions">
                            <button class="btn-lobby" id="ready-btn" onclick="toggleReady()">‚úì Ready</button>
                            <button class="btn-lobby primary" id="start-game-btn" onclick="startGame()" disabled
                                style="display:none;">
                                ‚ñ∂ Start Game
                            </button>
                        </div>

                        <div style="font-size:.72em;color:var(--text2);text-align:center;line-height:1.6;">
                            Mark yourself ready, then the host starts.<br>
                            AI players fill empty slots automatically.
                        </div>
                    </div>
                </div>

                <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ LUDO PANE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
                <div id="pane-ludo" style="width:100%;display:flex;flex-direction:column;align-items:center;gap:10px;">

                    <!-- Controls bar -->
                    <div class="game-controls">
                        <div class="dice doff" id="ludo-dice" onclick="LudoGame.rollDice()">üé≤</div>
                        <div>
                            <div style="font-size:.72em;color:var(--text2);margin-bottom:3px;">Players</div>
                            <div class="turn-dots" id="turn-dots"></div>
                        </div>
                        <div class="game-status-txt" id="game-status">Waiting to start‚Ä¶</div>
                        <button class="btn-game-sm" onclick="newGame('ludo')">‚Ü∫ New</button>
                    </div>

                    <!-- Board wrapper (holds the board + winner overlay) -->
                    <div style="position:relative;" id="ludo-board-wrap">
                        <div id="ludo-board"></div>
                        <!-- Winner overlay -->
                        <div class="winner-ov" id="ludo-winner">
                            <div class="w-emoji" id="ludo-winner-emoji">üèÜ</div>
                            <div class="w-text" id="ludo-winner-text">WINNER!</div>
                            <button class="btn-join" onclick="newGame('ludo')"
                                style="margin-top:12px;width:auto;padding:10px 24px;">
                                Play Again
                            </button>
                        </div>
                    </div>

                    <!-- Game log -->
                    <div class="game-log" id="game-log">Game events will appear here‚Ä¶</div>
                </div>

                <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ CHESS PANE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
                <div id="pane-chess" class="hidden" style="width:100%;display:flex;justify-content:center;">
                    <div class="chess-layout">

                        <!-- Board + coords -->
                        <div class="chess-board-wrap">
                            <div class="chess-coord-files" id="c-files"></div>
                            <div class="chess-rank-row">
                                <div class="chess-coord-ranks" id="c-ranks"></div>
                                <div style="position:relative;">
                                    <div id="chess-board"></div>
                                    <!-- Promotion modal -->
                                    <div class="promo-modal" id="promo-modal">
                                        <div class="promo-title">Promote pawn to:</div>
                                        <div class="promo-pieces" id="promo-pieces"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Side panel -->
                        <div class="chess-side">
                            <div class="c-box">
                                <h3>PLAYERS</h3>
                                <div class="p-slot active" id="chess-slot-w">
                                    <div class="p-dot" style="background:#ddd;border:1px solid #666;"></div>
                                    <div class="p-name" id="cname-w">You (White)</div>
                                </div>
                                <div class="p-slot" id="chess-slot-b">
                                    <div class="p-dot" style="background:#444;border:1px solid #888;"></div>
                                    <div class="p-name">Groq-AI (Black)</div>
                                </div>
                            </div>
                            <div class="c-box">
                                <h3>STATUS</h3>
                                <div class="c-status" id="c-status">Waiting to start‚Ä¶</div>
                            </div>
                            <div class="c-box">
                                <h3>CAPTURED</h3>
                                <div style="font-size:.7em;color:var(--text2);margin-bottom:3px;">White took:</div>
                                <div class="c-cap" id="cap-w"></div>
                                <div style="font-size:.7em;color:var(--text2);margin:5px 0 3px;">Black took:</div>
                                <div class="c-cap" id="cap-b"></div>
                            </div>
                            <div class="c-box">
                                <h3>MOVES</h3>
                                <div class="c-log" id="c-log"></div>
                            </div>
                            <button class="btn-undo" onclick="ChessGame.undo()">‚Ü© Undo move</button>
                            <button class="btn-game-sm" onclick="newGame('chess')" style="width:100%;margin-top:4px;">‚Ü∫
                                New Game</button>
                        </div>
                    </div>
                </div>

            </div><!-- /game-view -->
        </div><!-- /content-area -->
    </div><!-- /app -->

    <!-- ‚îÄ‚îÄ Vote banner ‚îÄ‚îÄ -->
    <div id="vote-banner" class="vote-banner" style="display:none;">
        <p class="vote-msg">Someone wants to join!</p>
        <div class="vote-btns">
            <button class="btn-accept" onclick="castVote(true)">‚úì Accept</button>
            <button class="btn-decline" onclick="castVote(false)">‚úï Decline</button>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     SCRIPTS (load order matters)
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <script src="games/ludo.js"></script>
    <script src="games/chess.js"></script>
    <script src="js/app.js"></script>

    <script>
        // ‚îÄ‚îÄ Build chess board coordinate labels on load ‚îÄ‚îÄ
        window.addEventListener("load", function () {
            const cfiles = document.getElementById("c-files");
            const cranks = document.getElementById("c-ranks");
            if (cfiles) {
                "abcdefgh".split("").forEach(f => {
                    const s = document.createElement("span"); s.textContent = f; cfiles.appendChild(s);
                });
            }
            if (cranks) {
                for (let r = 0; r < 8; r++) {
                    const s = document.createElement("span"); s.textContent = 8 - r; cranks.appendChild(s);
                }
            }

            // Build ludo board (visual only, no game state yet)
            if (window.LudoGame) {
                // Build board structure without starting game
                const bd = document.getElementById("ludo-board");
                if (bd && bd.children.length === 0) {
                    // Call internal board build by triggering a silent init
                    // The board will be properly built when init() is called
                }
            }
        });
    </script>
</body>

</html>