/* ══════════════════════════════════════════════════════════
   Squad.GG – style.css
   Mobile-first responsive design.
   Game fills screen on mobile, chat is live-stream overlay.
   Desktop: side-by-side layout.
   ══════════════════════════════════════════════════════════ */

/* ── Variables ── */
:root {
    --bg: #0b0b14;
    --surf: #15152a;
    --surf2: #1e1e38;
    --surf3: #272742;
    --border: #2e2e52;
    --border2: #3d3d65;
    --accent: #7c6af7;
    --accent2: #e879a0;
    --text: #e0e0f0;
    --text2: #8888aa;
    --text3: #5555aa;
    --red: #ff5577;
    --green: #44dd88;
    --blue: #4488ff;
    --yellow: #ffcc44;

    /* Board cell sizes — responsive via clamp */
    --ludo-cell: clamp(20px, calc((min(100vw, 92vh) - 100px) / 15), 40px);
    --chess-cell: clamp(36px, calc((min(100vw, 92vh) - 100px) / 8), 66px);
}

/* ── Reset ── */
*,
*::before,
*::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html,
body {
    height: 100%;
    overflow: hidden;
}

body {
    font-family: 'Inter', 'Segoe UI', sans-serif;
    background: var(--bg);
    color: var(--text);
    font-size: 14px;
}

/* ══════════════════════════════════════════
   SETUP SCREEN
   ══════════════════════════════════════════ */
#setup-screen {
    position: fixed;
    inset: 0;
    background: var(--bg);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 16px;
    z-index: 1000;
    padding: 24px;
}

#setup-screen h1 {
    font-size: 2.2em;
    font-weight: 700;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    letter-spacing: 2px;
    margin-bottom: 8px;
}

#setup-screen p {
    color: var(--text2);
    font-size: 0.9em;
}

.setup-field {
    width: 100%;
    max-width: 300px;
    padding: 13px 18px;
    background: var(--surf2);
    border: 1px solid var(--border);
    border-radius: 10px;
    color: var(--text);
    font-size: 0.95em;
    outline: none;
    text-align: center;
    transition: border-color .2s;
}

.setup-field:focus {
    border-color: var(--accent);
}

.btn-join {
    width: 100%;
    max-width: 300px;
    padding: 13px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    color: #fff;
    border: none;
    border-radius: 10px;
    font-size: 1em;
    font-weight: 700;
    cursor: pointer;
    letter-spacing: 0.5px;
    transition: opacity .15s, transform .15s;
}

.btn-join:hover {
    opacity: .9;
    transform: translateY(-1px);
}

/* ══════════════════════════════════════════
   APP SHELL (after join)
   ══════════════════════════════════════════ */
#app {
    display: none;
    height: 100%;
    flex-direction: column;
}

#app.visible {
    display: flex;
}

/* ── Top bar ── */
.top-bar {
    flex-shrink: 0;
    height: 48px;
    background: var(--surf);
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    padding: 0 14px;
    gap: 10px;
    z-index: 50;
}

.top-bar .logo {
    font-weight: 700;
    font-size: 1.1em;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    letter-spacing: 1px;
    flex-shrink: 0;
}

.room-pill {
    background: var(--surf3);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 2px 12px;
    font-size: 0.75em;
    color: var(--text2);
    flex-shrink: 0;
}

.top-bar .spacer {
    flex: 1;
}

.tab-btn {
    padding: 5px 13px;
    border-radius: 7px;
    border: 1px solid var(--border);
    background: var(--surf2);
    color: var(--text2);
    font-size: 0.8em;
    font-weight: 500;
    cursor: pointer;
    transition: .15s;
    flex-shrink: 0;
}

.tab-btn.active {
    background: var(--accent);
    color: #fff;
    border-color: var(--accent);
}

.tab-btn:hover:not(.active) {
    border-color: var(--accent);
    color: var(--accent);
}

/* Chat toggle (mobile) */
.chat-toggle-btn {
    width: 34px;
    height: 34px;
    background: var(--surf2);
    border: 1px solid var(--border);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1.1em;
    position: relative;
    flex-shrink: 0;
}

.chat-badge {
    position: absolute;
    top: -4px;
    right: -4px;
    width: 16px;
    height: 16px;
    background: var(--accent2);
    border-radius: 50%;
    font-size: 0.6em;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    color: #fff;
    display: none;
}

.chat-badge.visible {
    display: flex;
}

/* ══════════════════════════════════════════
   MAIN CONTENT AREA
   ══════════════════════════════════════════ */
.content-area {
    flex: 1;
    min-height: 0;
    position: relative;
    overflow: hidden;
}

/* ── GAME VIEW (fills content area) ── */
.game-view {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 12px;
    gap: 10px;
}

.game-view::-webkit-scrollbar {
    width: 3px;
}

.game-view::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 3px;
}

/* ── LOBBY VIEW ── */
.lobby-view {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
    gap: 14px;
}

/* ══════════════════════════════════════════
   LOBBY UI
   ══════════════════════════════════════════ */
.lobby-card {
    width: 100%;
    max-width: 440px;
    background: var(--surf);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 14px;
}

.lobby-card h2 {
    font-size: 1.1em;
    font-weight: 700;
    color: var(--text2);
    letter-spacing: .5px;
}

.player-row {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 9px 12px;
    background: var(--surf2);
    border: 1px solid var(--border);
    border-radius: 9px;
    transition: .2s;
}

.player-row.is-you {
    border-color: var(--accent);
}

.player-dot {
    width: 11px;
    height: 11px;
    border-radius: 50%;
    flex-shrink: 0;
}

.player-name {
    flex: 1;
    font-size: 0.88em;
    font-weight: 500;
}

.player-host-badge {
    font-size: 0.68em;
    color: var(--yellow);
    background: #33290a;
    border-radius: 4px;
    padding: 1px 6px;
    border: 1px solid var(--yellow);
}

.player-ready-badge {
    font-size: 0.72em;
    padding: 2px 8px;
    border-radius: 12px;
    border: 1px solid transparent;
}

.player-ready-badge.ready {
    color: var(--green);
    border-color: var(--green);
    background: #0a2a15;
}

.player-ready-badge.not-ready {
    color: var(--text3);
    border-color: var(--border);
}

.game-type-selector {
    display: flex;
    gap: 8px;
}

.game-type-btn {
    flex: 1;
    padding: 9px;
    background: var(--surf2);
    border: 1px solid var(--border);
    border-radius: 9px;
    cursor: pointer;
    font-size: 0.85em;
    text-align: center;
    transition: .15s;
    color: var(--text2);
}

.game-type-btn.selected {
    border-color: var(--accent);
    color: var(--accent);
    background: #1a1a38;
}

.lobby-actions {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.btn-lobby {
    flex: 1;
    min-width: 120px;
    padding: 11px;
    border-radius: 9px;
    border: 1px solid var(--border);
    background: var(--surf2);
    color: var(--text);
    cursor: pointer;
    font-size: 0.88em;
    font-weight: 600;
    transition: .15s;
}

.btn-lobby:hover {
    border-color: var(--accent);
    color: var(--accent);
}

.btn-lobby.primary {
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    color: #fff;
    border-color: transparent;
}

.btn-lobby.primary:hover {
    opacity: .88;
    transform: translateY(-1px);
}

.btn-lobby:disabled {
    opacity: .35;
    cursor: not-allowed;
}

/* Vote notification */
.vote-banner {
    position: fixed;
    top: 58px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 300;
    background: var(--surf);
    border: 1px solid var(--accent);
    border-radius: 12px;
    padding: 14px 18px;
    max-width: 340px;
    width: calc(100% - 32px);
    display: flex;
    flex-direction: column;
    gap: 10px;
    box-shadow: 0 8px 30px rgba(0, 0, 0, .7);
    animation: slideDown .3s ease;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(-10px);
    }
}

.vote-banner p {
    font-size: 0.9em;
}

.vote-btns {
    display: flex;
    gap: 8px;
}

.vote-btns button {
    flex: 1;
    padding: 8px;
    border-radius: 7px;
    border: none;
    font-weight: 600;
    cursor: pointer;
    font-size: 0.85em;
}

.btn-accept {
    background: var(--green);
    color: #000;
}

.btn-decline {
    background: var(--surf3);
    color: var(--text);
    border: 1px solid var(--border);
}

/* ══════════════════════════════════════════
   CHAT — OVERLAY (mobile & game mode)
   ══════════════════════════════════════════ */
.chat-overlay {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 200;
    display: flex;
    flex-direction: column;
    pointer-events: none;
    transition: height .3s cubic-bezier(.4, 0, .2, 1);
}

/* In overlay mode: messages float, input hidden */
.chat-overlay.collapsed {
    height: 220px;
}

/* Expanded: full chat */
.chat-overlay.expanded {
    height: calc(100% - 48px);
    pointer-events: all;
    background: var(--bg);
}

.chat-messages-float {
    flex: 1;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    gap: 4px;
    padding: 0 10px 8px;
    mask-image: linear-gradient(to bottom, transparent 0%, #000 40%);
    -webkit-mask-image: linear-gradient(to bottom, transparent 0%, #000 40%);
}

.chat-overlay.expanded .chat-messages-float {
    overflow-y: auto;
    mask-image: none;
    -webkit-mask-image: none;
    padding: 10px;
}

.chat-messages-float::-webkit-scrollbar {
    width: 3px;
}

.chat-messages-float::-webkit-scrollbar-thumb {
    background: var(--border);
}

/* Chat input bar (only visible when expanded) */
.chat-input-bar {
    display: none;
    padding: 8px 10px;
    background: rgba(15, 15, 25, .95);
    border-top: 1px solid var(--border);
    gap: 8px;
    pointer-events: all;
}

.chat-overlay.expanded .chat-input-bar {
    display: flex;
}

.chat-input-bar input {
    flex: 1;
    padding: 9px 13px;
    background: var(--surf2);
    border: 1px solid var(--border);
    border-radius: 8px;
    color: var(--text);
    font-size: 0.88em;
    outline: none;
}

.chat-input-bar input:focus {
    border-color: var(--accent);
}

.chat-send-btn {
    padding: 9px 16px;
    background: var(--accent);
    color: #fff;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    font-size: 0.83em;
}

.btn-file-img {
    width: 38px;
    height: 38px;
    background: var(--surf2);
    border: 1px solid var(--border);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1em;
}

.btn-file-img:hover {
    background: var(--surf3);
}

/* Chat close button (expanded state) */
.chat-close-btn {
    display: none;
    align-self: flex-end;
    margin: 6px 10px 0;
    padding: 4px 12px;
    background: var(--surf2);
    border: 1px solid var(--border);
    border-radius: 6px;
    color: var(--text2);
    cursor: pointer;
    font-size: 0.78em;
    pointer-events: all;
}

.chat-overlay.expanded .chat-close-btn {
    display: block;
}

/* ── Message bubbles ── */
.msg {
    display: inline-flex;
    flex-direction: column;
    max-width: 88%;
    pointer-events: all;
}

.msg-name {
    font-size: 0.68em;
    color: var(--text2);
    margin-bottom: 2px;
    font-weight: 600;
}

.msg-bubble {
    padding: 7px 11px;
    border-radius: 10px;
    font-size: 0.86em;
    line-height: 1.5;
    word-wrap: break-word;
    backdrop-filter: blur(10px);
}

/* Float mode: translucent */
.chat-overlay.collapsed .msg-bubble {
    background: rgba(21, 21, 42, .82);
    border: 1px solid rgba(255, 255, 255, .06);
}

/* Expanded mode: solid */
.chat-overlay.expanded .msg-bubble {
    backdrop-filter: none;
}

.msg-me {
    align-self: flex-end;
}

.msg-me .msg-bubble {
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    color: #fff;
}

.msg-other {
    align-self: flex-start;
}

.msg-other .msg-bubble {
    background: var(--surf2);
}

.msg-groq {
    align-self: flex-start;
}

.msg-groq .msg-bubble {
    background: #112a1a;
    border: 1px solid rgba(68, 221, 136, .25);
    color: #99ffcc;
}

.msg-router {
    align-self: flex-start;
}

.msg-router .msg-bubble {
    background: #111630;
    border: 1px solid rgba(68, 136, 255, .25);
    color: #aaccff;
}

.msg-system {
    align-self: center;
    font-size: 0.75em;
    color: var(--text3);
    font-style: italic;
    padding: 2px 10px;
    background: rgba(255, 255, 255, .04);
    border-radius: 20px;
    text-align: center;
}

.msg-game-event {
    align-self: center;
    font-size: 0.75em;
    color: rgba(255, 204, 68, .8);
    background: rgba(255, 204, 68, .06);
    border: 1px solid rgba(255, 204, 68, .15);
    border-radius: 6px;
    padding: 3px 10px;
    text-align: center;
    pointer-events: all;
}

/* ══════════════════════════════════════════
   GAME CONTROLS BAR (bottom of game view)
   ══════════════════════════════════════════ */
.game-controls {
    width: 100%;
    max-width: 600px;
    background: var(--surf);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 10px 16px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    flex-wrap: wrap;
    flex-shrink: 0;
}

.dice {
    width: 54px;
    height: 54px;
    background: linear-gradient(145deg, #26264a, #181830);
    border: 2px solid var(--accent);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2em;
    cursor: pointer;
    box-shadow: 0 4px 14px rgba(124, 106, 247, .3);
    user-select: none;
    transition: .15s;
}

.dice:hover:not(.off) {
    transform: scale(1.07);
    background: var(--surf3);
}

.dice:active:not(.off) {
    transform: scale(.9);
}

.dice.off {
    opacity: .3;
    cursor: not-allowed;
    border-color: var(--border);
    box-shadow: none;
}

.dice.rolling {
    animation: droll .4s ease;
}

@keyframes droll {
    0% {
        transform: rotate(0) scale(1);
    }

    30% {
        transform: rotate(-22deg) scale(1.2);
    }

    65% {
        transform: rotate(18deg) scale(.9);
    }

    100% {
        transform: rotate(0) scale(1);
    }
}

.turn-dots {
    display: flex;
    gap: 7px;
    align-items: center;
}

.t-dot {
    width: 26px;
    height: 26px;
    border-radius: 50%;
    border: 2px solid transparent;
    transition: .2s;
}

.t-dot.active {
    border-color: #fff;
    box-shadow: 0 0 12px rgba(255, 255, 255, .6);
    transform: scale(1.2);
}

.game-status-txt {
    font-size: 0.8em;
    color: var(--text2);
    flex: 1;
    text-align: right;
}

.btn-game-sm {
    padding: 7px 14px;
    background: var(--surf2);
    border: 1px solid var(--border);
    border-radius: 8px;
    color: var(--text);
    cursor: pointer;
    font-size: 0.8em;
    font-weight: 500;
    transition: .15s;
}

.btn-game-sm:hover {
    border-color: var(--accent);
    color: var(--accent);
}

/* Game log */
.game-log {
    width: 100%;
    max-width: 600px;
    height: 60px;
    background: var(--surf2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 7px 11px;
    font-size: 0.73em;
    overflow-y: auto;
    color: var(--text2);
    line-height: 1.65;
    flex-shrink: 0;
}

.game-log::-webkit-scrollbar {
    width: 3px;
}

.game-log::-webkit-scrollbar-thumb {
    background: var(--border);
}

/* ══════════════════════════════════════════
   LUDO BOARD
   ══════════════════════════════════════════ */
#ludo-board {
    display: grid;
    grid-template-columns: repeat(15, var(--ludo-cell));
    grid-template-rows: repeat(15, var(--ludo-cell));
    gap: 2px;
    background: #05050e;
    border: 3px solid var(--border);
    border-radius: 10px;
    padding: 2px;
    box-shadow: 0 0 60px rgba(124, 106, 247, .1), inset 0 0 30px rgba(0, 0, 0, .5);
    flex-shrink: 0;
}

.lc {
    width: var(--ludo-cell);
    height: var(--ludo-cell);
    background: #121225;
    border-radius: 3px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    border: 1px solid rgba(255, 255, 255, .04);
}

/* Home zones */
.lhr {
    background: radial-gradient(circle at 55% 35%, #ff8899, #cc1133) !important;
    border-color: #ff557760 !important;
}

.lhg {
    background: radial-gradient(circle at 45% 65%, #88ffaa, #117733) !important;
    border-color: #44dd8860 !important;
}

.lhb {
    background: radial-gradient(circle at 45% 35%, #99bbff, #1133bb) !important;
    border-color: #4488ff60 !important;
}

.lhy {
    background: radial-gradient(circle at 55% 65%, #ffe077, #bb7700) !important;
    border-color: #ffcc4460 !important;
}

/* Path */
.lpath {
    background: #1a1a30 !important;
    border-color: rgba(255, 255, 255, .08) !important;
}

/* Colored lanes */
.lpr {
    background: #280e16 !important;
}

.lpg {
    background: #0e2814 !important;
}

.lpb {
    background: #0e1628 !important;
}

.lpy {
    background: #281e0e !important;
}

/* Home stretch */
.lsr {
    background: linear-gradient(135deg, #3a0810, #5a1020) !important;
    border-color: var(--red) !important;
}

.lsg {
    background: linear-gradient(135deg, #083a10, #10501a) !important;
    border-color: var(--green) !important;
}

.lsb {
    background: linear-gradient(135deg, #08103a, #101850) !important;
    border-color: var(--blue) !important;
}

.lsy {
    background: linear-gradient(135deg, #2a2008, #44340c) !important;
    border-color: var(--yellow) !important;
}

/* Safe star */
.lsafe::after {
    content: '★';
    font-size: clamp(10px, calc(var(--ludo-cell) * 0.42), 16px);
    color: #ffcc44;
    text-shadow: 0 0 8px #ffcc44aa;
    position: absolute;
}

/* Center */
.lcenter {
    background: conic-gradient(var(--red) 0 90deg, var(--green) 90deg 180deg, var(--blue) 180deg 270deg, var(--yellow) 270deg 360deg) !important;
    border-radius: 50% !important;
    border: 2px solid rgba(255, 255, 255, .2) !important;
    box-shadow: 0 0 20px rgba(255, 255, 255, .12);
}

.lcircle::after {
    content: '';
    width: calc(var(--ludo-cell) * 0.68);
    height: calc(var(--ludo-cell) * 0.68);
    border-radius: 50%;
    border: 2.5px solid rgba(255, 255, 255, .18);
    position: absolute;
}

/* Tokens */
.tok {
    position: absolute;
    width: calc(var(--ludo-cell) * 0.6);
    height: calc(var(--ludo-cell) * 0.6);
    border-radius: 50%;
    border: 2px solid rgba(255, 255, 255, .5);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: calc(var(--ludo-cell) * 0.22);
    font-weight: 700;
    color: #000;
    z-index: 10;
    transition: transform .18s;
    box-shadow: 0 2px 10px rgba(0, 0, 0, .7), inset 0 1px 4px rgba(255, 255, 255, .35);
}

.tok-r {
    background: radial-gradient(circle at 32% 30%, #ffaabc, var(--red));
}

.tok-g {
    background: radial-gradient(circle at 32% 30%, #aaffcc, var(--green));
}

.tok-b {
    background: radial-gradient(circle at 32% 30%, #aabbff, var(--blue));
}

.tok-y {
    background: radial-gradient(circle at 32% 30%, #ffe999, var(--yellow));
    color: #2a1a00;
}

.tok.mov {
    animation: tpulse .65s infinite alternate;
    cursor: pointer;
    border-color: #fff;
    z-index: 20;
}

@keyframes tpulse {
    from {
        box-shadow: 0 0 0 0 rgba(255, 255, 255, .45), 0 2px 10px rgba(0, 0, 0, .7);
    }

    to {
        box-shadow: 0 0 0 8px rgba(255, 255, 255, 0), 0 2px 10px rgba(0, 0, 0, .7);
    }
}

/* Winner overlay */
.winner-ov {
    position: absolute;
    inset: 0;
    background: rgba(5, 5, 14, .92);
    backdrop-filter: blur(6px);
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 12px;
    border-radius: 8px;
    z-index: 100;
}

.winner-ov.show {
    display: flex;
}

.w-emoji {
    font-size: 4em;
    animation: wob 1s ease infinite alternate;
}

@keyframes wob {
    from {
        transform: rotate(-10deg) scale(1);
    }

    to {
        transform: rotate(10deg) scale(1.12);
    }
}

.w-text {
    font-size: 2em;
    font-weight: 700;
    background: linear-gradient(135deg, var(--yellow), var(--accent2));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-align: center;
}

/* ══════════════════════════════════════════
   CHESS BOARD
   ══════════════════════════════════════════ */
.chess-layout {
    display: flex;
    gap: 16px;
    align-items: flex-start;
    justify-content: center;
    flex-wrap: wrap;
}

.chess-board-wrap {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.chess-coord-files {
    display: flex;
    padding-left: var(--chess-cell);
}

.chess-coord-files span {
    width: var(--chess-cell);
    text-align: center;
    font-size: 0.68em;
    color: var(--text3);
}

.chess-coord-ranks {
    display: flex;
    flex-direction: column;
}

.chess-coord-ranks span {
    height: var(--chess-cell);
    display: flex;
    align-items: center;
    width: var(--chess-cell);
    justify-content: flex-end;
    padding-right: 4px;
    font-size: 0.68em;
    color: var(--text3);
}

.chess-rank-row {
    display: flex;
}

#chess-board {
    display: grid;
    grid-template-columns: repeat(8, var(--chess-cell));
    grid-template-rows: repeat(8, var(--chess-cell));
    border: 3px solid var(--border);
    border-radius: 6px;
    overflow: hidden;
    box-shadow: 0 0 40px rgba(124, 106, 247, .12);
    flex-shrink: 0;
}

.cc {
    width: var(--chess-cell);
    height: var(--chess-cell);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: calc(var(--chess-cell) * 0.58);
    cursor: pointer;
    position: relative;
    transition: background .1s;
    user-select: none;
}

.cc.lt {
    background: #22223a;
}

.cc.dk {
    background: #131326;
}

.cc.sel {
    background: rgba(124, 106, 247, .35) !important;
    outline: 3px inset rgba(124, 106, 247, .8);
}

.cc.lm::after {
    content: '';
    width: 40%;
    height: 40%;
    border-radius: 50%;
    background: rgba(124, 106, 247, .55);
    position: absolute;
}

.cc.lc2 {
    background: rgba(255, 85, 119, .22) !important;
}

.cc.chk {
    background: rgba(255, 40, 40, .4) !important;
    animation: chka .6s ease infinite alternate;
}

@keyframes chka {
    from {
        background: rgba(255, 40, 40, .28);
    }

    to {
        background: rgba(255, 40, 40, .55);
    }
}

.cc:hover:not(.lm):not(.sel) {
    filter: brightness(1.3);
}

/* Chess side panel */
.chess-side {
    display: flex;
    flex-direction: column;
    gap: 10px;
    min-width: 170px;
    max-width: 220px;
}

.c-box {
    background: var(--surf);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 12px;
}

.c-box h3 {
    font-size: 0.8em;
    color: var(--text2);
    margin-bottom: 7px;
    letter-spacing: .5px;
}

.p-slot {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 7px 9px;
    border-radius: 7px;
    background: var(--surf2);
    border: 1px solid transparent;
    margin-bottom: 5px;
    transition: .2s;
}

.p-slot.active {
    border-color: var(--accent);
    background: #1a1a36;
}

.p-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    flex-shrink: 0;
}

.p-name {
    flex: 1;
    font-size: 0.82em;
    font-weight: 500;
}

.c-status {
    padding: 8px;
    background: var(--surf2);
    border-radius: 7px;
    font-size: 0.8em;
    text-align: center;
}

.c-cap {
    display: flex;
    flex-wrap: wrap;
    gap: 1px;
    font-size: 1.1em;
    min-height: 24px;
    padding: 3px;
    background: var(--surf2);
    border-radius: 5px;
}

.c-log {
    height: 130px;
    overflow-y: auto;
    font-size: 0.72em;
    color: var(--text2);
    line-height: 1.75;
}

.c-log::-webkit-scrollbar {
    width: 3px;
}

.c-log::-webkit-scrollbar-thumb {
    background: var(--border);
}

.move-row {
    display: flex;
    gap: 5px;
}

.mn {
    color: var(--text3);
    min-width: 20px;
}

.mw {
    color: #ddd;
    min-width: 48px;
}

.mb2 {
    color: var(--text2);
}

.btn-undo {
    width: 100%;
    padding: 8px;
    background: var(--surf2);
    border: 1px solid var(--border);
    border-radius: 7px;
    color: var(--text);
    cursor: pointer;
    font-size: 0.8em;
    transition: .15s;
}

.btn-undo:hover {
    border-color: var(--accent);
    color: var(--accent);
}

/* Chess promotion modal */
.promo-modal {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: var(--surf);
    border: 2px solid var(--accent);
    border-radius: 12px;
    padding: 18px;
    z-index: 200;
    display: none;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, .85);
}

.promo-modal.show {
    display: flex;
}

.promo-title {
    font-size: 0.9em;
    color: var(--text2);
}

.promo-pieces {
    display: flex;
    gap: 9px;
}

.pp {
    font-size: calc(var(--chess-cell) * 0.55);
    cursor: pointer;
    padding: 5px;
    border-radius: 7px;
    background: var(--surf2);
    border: 2px solid var(--border);
    transition: .15s;
}

.pp:hover {
    border-color: var(--accent);
    transform: scale(1.1);
}

/* ══════════════════════════════════════════
   DESKTOP LAYOUT (sidebar chat)
   ══════════════════════════════════════════ */
@media (min-width: 768px) {
    #app {
        flex-direction: column;
    }

    .content-area {
        display: grid;
        grid-template-columns: 340px 1fr;
        gap: 0;
    }

    /* Chat is a proper sidebar on desktop */
    .chat-overlay {
        position: static;
        height: 100% !important;
        border-right: 1px solid var(--border);
        pointer-events: all;
        background: var(--surf);
        display: flex;
        flex-direction: column;
    }

    .chat-overlay.collapsed {
        height: 100% !important;
    }

    .chat-messages-float {
        mask-image: none;
        -webkit-mask-image: none;
        overflow-y: auto;
        padding: 12px;
        flex: 1;
    }

    .chat-input-bar {
        display: flex !important;
    }

    .chat-close-btn {
        display: none !important;
    }

    .chat-toggle-btn {
        display: none;
    }

    /* Game view takes remaining space */
    .game-view {
        padding: 16px;
    }

    .lobby-view {
        padding: 30px;
    }
}

/* ══════════════════════════════════════════
   MISC UTILS
   ══════════════════════════════════════════ */
.hidden {
    display: none !important;
}

.spin {
    animation: spin .8s linear infinite;
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

/* Toasts */
.toast {
    position: fixed;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--surf);
    border: 1px solid var(--accent);
    border-radius: 10px;
    padding: 10px 18px;
    font-size: 0.85em;
    color: var(--text);
    box-shadow: 0 8px 24px rgba(0, 0, 0, .6);
    z-index: 500;
    animation: toastIn .3s ease, toastOut .3s ease 2.7s forwards;
    pointer-events: none;
}

@keyframes toastIn {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(10px);
    }
}

@keyframes toastOut {
    to {
        opacity: 0;
        transform: translateX(-50%) translateY(10px);
    }
}